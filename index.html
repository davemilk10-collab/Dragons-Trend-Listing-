<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dragons Trend ‚Äî Listings (Solana)</title>
  <style>
    :root{--bg:#000;--card:#fff;--accent:#00c853;--accent2:#ffea00;--muted:#555}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;background:#000;color:#000}
    header{padding:18px 22px;display:flex;align-items:center;gap:16px;background:#000;color:#fff}
    .brand{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#000}
    h1{margin:0;font-size:22px;color:yellow}
    .container{max-width:1200px;margin:18px auto;padding:18px}
    .two-col{display:grid;grid-template-columns:1fr 380px;gap:18px}
    .card{background:#fff;padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.2);margin-bottom:18px;color:#000}
    label{display:block;font-size:13px;color:#222;margin-bottom:6px}
    input[type=text],textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;background:transparent;color:#000}
    input[type=file]{color:#222}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
    .btn-primary{background:linear-gradient(90deg,var(--accent),#00e676);color:#012}
    .btn-ghost{background:transparent;border:1px solid #ccc;color:#333}
    .small{font-size:13px;color:#555}
    .project-card{display:grid;grid-template-columns:100px 1fr;gap:12px;padding:12px;border-radius:10px;background:#fff;margin-bottom:12px;color:#000;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
    .proj-logo{width:80px;height:80px;border-radius:50%;overflow:hidden;flex-shrink:0;border:2px solid #ccc;box-shadow:0 2px 6px rgba(0,0,0,0.2);display:flex;align-items:center;justify-content:center;background:#eee}
    .proj-logo img{width:100%;height:100%;object-fit:cover}
    .proj-head{display:flex;align-items:center;justify-content:space-between}
    .links a{margin-right:8px;text-decoration:none;color:var(--accent)}
    .stats{display:flex;gap:12px;margin-top:8px;flex-wrap:wrap}
    .stat{background:#f6f6f6;padding:8px;border-radius:8px;font-size:13px}
    iframe.chart{width:100%;height:260px;border:0;margin-top:10px;border-radius:8px}
    footer{padding:14px;text-align:center;color:#888}
    @media(max-width:900px){.two-col{grid-template-columns:1fr}.project-card{grid-template-columns:80px 1fr}}
  </style>
</head>
<body>
  <header>
    <div class="brand">DR</div>
    <div style="flex:1">
      <h1>Dragons Trend ‚Äî Listings</h1>
      <div class="small">Discover, track, and list Solana projects ‚Äî Premium & Free boards with live stats.</div>
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="connectBtn" class="btn btn-primary">Connect Phantom</button>
      <button id="wcBtn" class="btn btn-ghost">WalletConnect</button>
    </div>
  </header>

  <main class="container">
    <div class="two-col">
      <div>
        <h2 style="color:yellow">Premium Top Leaderboard (0.5 SOL)</h2>
        <div id="premium-board"></div>
        <h2 style="color:yellow">Free Listing Board</h2>
        <div id="free-board"></div>
      </div>
      <div>
        <div class="card">
          <h3>Add Your Project</h3>
          <form id="listingForm">
            <label>Project Name</label>
            <input type="text" id="name" required />
            <label>Website</label>
            <input type="text" id="website" />
            <label>Twitter Link</label>
            <input type="text" id="twitter" />
            <label>Telegram Link</label>
            <input type="text" id="telegram" />
            <label>Dexscreener Pair URL</label>
            <input type="text" id="dex" required />
            <label>Logo</label>
            <input type="file" id="logo" accept="image/*" required />
            <label>Listing Type</label>
            <select id="listingType">
              <option value="free">Free</option>
              <option value="premium">Premium (0.5 SOL)</option>
            </select>
            <br><br>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
        </div>
      </div>
    </div>
  </main>

  <footer>¬© 2025 Dragons Trend ‚Äî Premium + Free Listings</footer>

  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  <script>
    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'));
    const premiumBoard = document.getElementById('premium-board');
    const freeBoard = document.getElementById('free-board');
    const STORAGE_KEY = 'dragonsTrendListings';
    let wallet = null;

    // Load saved listings
    let listings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

    // Render projects
    async function render() {
      premiumBoard.innerHTML = '';
      freeBoard.innerHTML = '';
      for (const proj of listings) {
        const card = document.createElement('div');
        card.className = 'project-card';
        card.innerHTML = `
          <div class="proj-logo">${proj.logo ? `<img src="${proj.logo}" />` : ''}</div>
          <div>
            <div class="proj-head">
              <h3 style="color:yellow">${proj.name}</h3>
              <div class="links">
                ${proj.website ? `<a href="${proj.website}" target="_blank">üåê</a>` : ''}
                ${proj.twitter ? `<a href="${proj.twitter}" target="_blank">ùïè</a>` : ''}
                ${proj.telegram ? `<a href="${proj.telegram}" target="_blank">‚úàÔ∏è</a>` : ''}
              </div>
            </div>
            <div class="stats" id="stats-${proj.id}">
              <div class="stat">Loading stats...</div>
            </div>
            <iframe class="chart" src="${proj.dex}" loading="lazy"></iframe>
          </div>
        `;
        if (proj.type === 'premium') premiumBoard.appendChild(card);
        else freeBoard.appendChild(card);
        fetchStats(proj.dex, `stats-${proj.id}`);
      }
    }

    // Fetch Dexscreener stats
    async function fetchStats(url, containerId) {
      try {
        const parts = url.split('/');
        const chain = parts[3], pair = parts[4];
        const res = await fetch(`https://api.dexscreener.com/latest/dex/pairs/${chain}/${pair}`);
        const data = await res.json();
        const info = data.pairs ? data.pairs[0] : null;
        if (info) {
          document.getElementById(containerId).innerHTML = `
            <div class="stat">Price: $${info.priceUsd}</div>
            <div class="stat">MCap: $${info.fdv}</div>
            <div class="stat">Liquidity: $${info.liquidity.usd}</div>
            <div class="stat">Vol 24h: $${info.volume.h24}</div>
          `;
        }
      } catch(e) {
        console.error(e);
      }
    }

    // Form submit
    document.getElementById('listingForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const website = document.getElementById('website').value;
      const twitter = document.getElementById('twitter').value;
      const telegram = document.getElementById('telegram').value;
      const dex = document.getElementById('dex').value;
      const type = document.getElementById('listingType').value;
      const logoFile = document.getElementById('logo').files[0];

      let logoData = '';
      if (logoFile) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          logoData = evt.target.result;
          saveListing();
        };
        reader.readAsDataURL(logoFile);
      } else {
        saveListing();
      }

      function saveListing() {
        const newProj = {id:Date.now(), name, website, twitter, telegram, dex, type, logo:logoData};
        if (type === 'premium') {
          alert('Please pay 0.5 SOL to complete Premium listing.');
        }
        listings.push(newProj);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(listings));
        render();
      }
    });

    // Render existing listings
    render();
  </script>
</body>
</html>
